!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t){t.exports=JSON.parse('{"supportedLanguages":["en_US"],"title":{"en_US":"CrossCode Area Editor","ko_KR":"크로스코드 지역 에디타"},"languages":{"en_US":"English","de_DE":"Deutsch","zh_CN":"简体中文","ja_JP":"日本語","ko_KR":"한국어","zh_TW":"簡體中文","ru_RU":"Русский","fr_FR":"Français"},"floorUpper":{"en_US":"F","de_DE":"E","zh_CN":"层","ja_JP":"階","ko_KR":"층","zh_TW":"層"},"floorGround":{"en_US":"GF","de_DE":"EG","zh_CN":"基层","ja_JP":"地階","ko_KR":"지상","zh_TW":"基層"},"floorLower":{"en_US":"U","de_DE":"U","zh_CN":"U","ja_JP":"地下","ko_KR":"U","zh_TW":"U"},"untitled":{"en_US":"untitled","de_DE":"unbetitelt","zh_CN":"未命名","ja_JP":"無題","ko_KR":"미정","zh_TW":"未命名"}}')},function(t,e,n){"use strict";n.r(e);var o={};n.r(o),n.d(o,"VIEWS",(function(){return T})),n.d(o,"render",(function(){return _})),n.d(o,"createArea",(function(){return b})),n.d(o,"loadArea",(function(){return L})),n.d(o,"setTile",(function(){return N})),n.d(o,"setBox",(function(){return R})),n.d(o,"setBoxPreview",(function(){return A})),n.d(o,"moveConnection",(function(){return B})),n.d(o,"rotateConnection",(function(){return k})),n.d(o,"resizeConnection",(function(){return U})),n.d(o,"moveIcon",(function(){return M})),n.d(o,"select",(function(){return z})),n.d(o,"highlight",(function(){return F})),n.d(o,"panView",(function(){return P})),n.d(o,"resetView",(function(){return $})),n.d(o,"setView",(function(){return j})),n.d(o,"switchZoom",(function(){return D})),n.d(o,"switchFloor",(function(){return K}));var i=new class{constructor(){this.palette=[0]}getColor(t,e=!1){if(t<0)throw new RangeError(`Index out of bounds at getColor(${t})!`);t in this.palette||(this.palette[t]=Math.floor(16777216*Math.random()));const n=this.palette[t];return"#"+(e?function(t){if(t>16777215||t<0)throw new RangeError(`Color "${t}" provided to getInverse is not a valid RGB value!`);return 16777215&~t}(n):n).toString(16).padStart(6,"0")}generateNewPalette(){this.palette.splice(1)}};class s{constructor(t,e){this.width=t,this.height=e,this.data=new Uint8Array(t*e)}static from(t){var e;const n=t.length,o=t[0].length,i=new s(o,n);for(let s=0;s<n;s++){t[s].length!==o&&console.warn("This matrix does not have the same width throughout!",t);for(let n=0;n<o;n++)i.set(n,s,null!==(e=t[s][n])&&void 0!==e?e:0)}return i}get(t,e){if(!(t>=this.width||t<0||e>=this.height||e<0))return this.data[this.width*e+t]}set(t,e,n){if(t>=this.width||t<0||e>=this.height||e<0)throw new RangeError(`Index out of bounds! Called (${t}, ${e}) of width ${this.width} x height ${this.height}.`);this.data[this.width*e+t]=n}resize(t,e,n=0,o=0){const i=new Uint8Array(t*e);for(let s=0;s<this.data.length;s++){const r=s%this.width+n,l=Math.floor(s/this.width)+o;r>=0&&r<t&&l>=0&&l<e&&(i[t*l+r]=this.data[s])}this.data=i,this.width=t,this.height=e}iterate(t){for(let e=0;e<this.data.length;e++){const n=t(e%this.width,Math.floor(e/this.width),this.data[e]);"number"==typeof n&&(this.data[e]=n)}}getWidth(){return this.width}getHeight(){return this.height}toJSON(){const t=new Array(this.height);for(let e=0;e<this.height;e++)t[e]=Array.from(this.data.slice(this.width*e,this.width*(e+1)));return t}}var r=new class{constructor(){var t,e;let n;try{n=JSON.parse(null!==(t=window.localStorage.getItem("CCAE"))&&void 0!==t?t:"{}")}catch(t){n={}}this.language=null!==(e=n.language)&&void 0!==e?e:"en_US",this.save()}set(t,e){return t in this&&(this[t]=e,this.save(),!0)}save(){window.localStorage.setItem("CCAE",JSON.stringify(this))}},l=n(0);class a{constructor(t){if(this.languages={en_US:""},t)for(const e in t)"langUid"!==e&&(this.languages[e]=t[e])}get(t=r.language){var e;return t in this.languages?this.languages[t]:null!==(e=this.languages.en_US)&&void 0!==e?e:""}getClean(t=r.language){let e=this.get(t);return/<<[AC]/g.test(e)&&(e=e.substring(0,e.search(/<<[AC]/g))),e}toJSON(){return this.languages}}l.supportedLanguages;delete l.supportedLanguages;const h={};for(const t in l)h[t]=new a(l[t]);function c(t,e,n){void 0!==n&&n<t.length?t.splice(n,0,e):t.push(e)}function d(t,e,n){t.splice(n,0,t.splice(e,1)[0])}function u(t,e){void 0!==e?t.splice(e,1):t.pop()}document.title=h.title.get();class f{constructor(t,e,n){if(this.level=t,e.constructor===s)this.tiles=e;else{if(e.constructor!==Number||!n)throw`Invalid constructor call to Floor! new Floor(${t}, ${e}, ${n})`;this.tiles=new s(e,n)}this.icons=[],this.maps=[],this.connections=[],this.landmarks=[]}static from(t){const e=new f(t.level,s.from(t.tiles));t.handle&&(e.handle=new a(t.handle));for(const n of t.maps)e.maps.push(new g(n));for(const n of t.connections)e.connections.push(new v(n));for(const n of t.icons)e.icons.push(new m(n));for(const n of t.landmarks)e.landmarks.push(new w(n));return e}setTile(t,e,n){if(n>this.maps.length)throw`Error: Attempted to place a tile with the value of ${n}, but the maximum allowed index is ${this.maps.length}! If you want to use more maps, you have to do so by calling Floor.addMap(...)!`;this.tiles.set(t,e,n)}getFloorName(){return this.handle?this.handle.getClean():0===this.level?h.floorGround.get():this.level>0?Math.abs(this.level)+h.floorUpper.get():this.level<0?h.floorLower.get()+Math.abs(this.level):"N/A"}render(t,e){if(t)if(rt.generateTilesAdvanced(this.tiles,null==e?void 0:e.isolate),null==e?void 0:e.debugConnectionsMode)for(let t=0;t<this.connections.length;t++){const n=this.connections[t];e.select&&t!==e.select||rt.drawDebugConnection(n.tx,n.ty,"VERTICAL"===n.dir,n.size)}else if(null==e?void 0:e.isolate){for(let t=0;t<this.icons.length;t++){const n=this.icons[t];!e.isolate.includes(n.map+1)||e.select&&t!==e.select||rt.drawIcon(n.x,n.y,n.icon)}for(let t=0;t<this.landmarks.length;t++){const n=this.landmarks[t];e.isolate.includes(n.map+1)&&rt.drawIcon(n.x,n.y,"landmark")}}else{for(const t of this.connections)rt.drawConnection(t.tx,t.ty,"VERTICAL"===t.dir,t.size);for(const t of this.icons)rt.drawIcon(t.x,t.y,t.icon);for(const t of this.landmarks)rt.drawIcon(t.x,t.y,"landmark")}else rt.generateTiles(this.tiles,null==e?void 0:e.isolate)}resize(t,e,n=0,o=0){if(this.tiles.resize(t,e,n,o),0!==n||0!==o){const t=[],e=[],i=[];for(let e=0;e<this.connections.length;e++){const i=this.connections[e];i.tx+=n,i.ty+=o,(i.tx<0||i.ty<0)&&t.push(e)}for(let t=0;t<this.icons.length;t++){const i=this.icons[t];i.x+=8*n,i.y+=8*o,(i.x<0||i.y<0)&&e.push(t)}for(let t=0;t<this.landmarks.length;t++){const e=this.landmarks[t];e.x+=8*n,e.y+=8*o,(e.x<0||e.y<0)&&i.push(t)}for(const e of t)this.removeConnection(e);for(const t of e)this.removeIcon(t);for(const t of i)this.removeLandmark(t)}}addMap(t,e,n){c(this.maps,new g({path:t,name:e}),n)}moveMap(t,e){d(this.maps,t,e)}removeMap(t){u(this.maps,t)}addConnection(t,e,n,o,i,s,r){c(this.connections,new v({tx:t,ty:e,dir:s?"VERTICAL":"HORIZONTAL",size:i,map1:n,map2:o}),r)}moveConnection(t,e){d(this.connections,t,e)}removeConnection(t){u(this.connections,t)}addIcon(t,e,n,o,i){c(this.icons,new m({icon:t,x:e,y:n,map:o}),i)}moveIcon(t,e){d(this.icons,t,e)}removeIcon(t){u(this.icons,t)}addLandmark(t,e,n,o,i){c(this.landmarks,new w({id:t,x:e,y:n,map:o}),i)}moveLandmark(t,e){d(this.landmarks,t,e)}removeLandmark(t){u(this.icons,t)}getMapIndexByPosition(t,e){var n;return null!==(n=this.tiles.get(t,e))&&void 0!==n?n:-1}getConnectionIndexByPosition(t,e){for(let n=0;n<this.connections.length;n++){const o=this.connections[n],i="VERTICAL"===o.dir,s=o.tx,r=o.ty,l=i?s+o.size-1:s+1,a=i?r+1:r+o.size-1;if(t>=s&&t<=l&&e>=r&&e<=a)return n}return-1}getIconIndexByPosition(t,e){for(let n=0;n<this.icons.length;n++){const o=this.icons[n],[i,s,r,l]=rt.getIconBounds(o.x,o.y,o.icon);if(t>=i&&t<=r&&e>=s&&e<=l)return n}for(let n=0;n<this.landmarks.length;n++){const o=this.landmarks[n],[i,s,r,l]=rt.getIconBounds(o.x,o.y,"landmark");if(t>=i&&t<=r&&e>=s&&e<=l)return~n-1}return-1}getMapByIndex(t){return this.maps[t]}getConnectionByIndex(t){return this.connections[t]}getIconByIndex(t){return this.icons[t]}getLandmarkByIndex(t){return this.landmarks[t]}}class g{constructor(t){var e;this.path=null!==(e=null==t?void 0:t.path)&&void 0!==e?e:"",this.name=new a(null==t?void 0:t.name)}}class v{constructor(t){var e,n,o,i,s;this.tx=null!==(e=null==t?void 0:t.tx)&&void 0!==e?e:0,this.ty=null!==(n=null==t?void 0:t.ty)&&void 0!==n?n:0,this.dir=["HORIZONTAL","VERTICAL"].includes(null==t?void 0:t.dir)?null==t?void 0:t.dir:"HORIZONTAL",this.size=null!==(o=null==t?void 0:t.size)&&void 0!==o?o:1,this.map1=null!==(i=null==t?void 0:t.map1)&&void 0!==i?i:0,this.map2=null!==(s=null==t?void 0:t.map2)&&void 0!==s?s:0,this.condition=null==t?void 0:t.condition,this.offset=null==t?void 0:t.offset}}class m{constructor(t){var e,n,o,i;this.icon=null!==(e=null==t?void 0:t.icon)&&void 0!==e?e:"chest",this.x=null!==(n=null==t?void 0:t.x)&&void 0!==n?n:0,this.y=null!==(o=null==t?void 0:t.y)&&void 0!==o?o:0,this.map=null!==(i=null==t?void 0:t.map)&&void 0!==i?i:0,this.data=null==t?void 0:t.data}}class w{constructor(t){var e,n,o,i;this.id=null!==(e=null==t?void 0:t.id)&&void 0!==e?e:"",this.x=null!==(n=null==t?void 0:t.x)&&void 0!==n?n:0,this.y=null!==(o=null==t?void 0:t.y)&&void 0!==o?o:0,this.map=null!==(i=null==t?void 0:t.map)&&void 0!==i?i:0}}class p{constructor(t){var e,n,o;if(this.width=null!==(e=null==t?void 0:t.width)&&void 0!==e?e:1,this.height=null!==(n=null==t?void 0:t.height)&&void 0!==n?n:1,this.floors=[],(null===(o=null==t?void 0:t.floors)||void 0===o?void 0:o.length)>0)for(const e of null==t?void 0:t.floors)this.floors.push(f.from(e));else this.addFloor();this.defaultFloor=null==t?void 0:t.defaultFloor}getFloorByIndex(t){if(t<0||t>=this.floors.length)throw`A floor by the index ${t} was attempted to be fetched but no floor by that index exists!`;return this.floors[t]}getFloorByLevel(t){for(const e of this.floors)if(t===e.level)return e}getIndexByLevel(t){for(let e=0;e<this.floors.length;e++)if(t===this.floors[e].level)return e}resize(t,e,n=0,o=0){if(t<0||e<0)throw new RangeError("You cannot resize the area to be less than 0 in width or height!");for(const i of this.floors)i.resize(t,e,n,o);this.width=t,this.height=e}addFloor(t){let e=0;if(this.floors.length>0){const n=null!=t?t:this.floors.length;e=n>=this.floors.length?this.floors[n-1].level+1:this.floors[n].level-1}c(this.floors,new f(e,this.width,this.height),t)}moveFloor(t,e){d(this.floors,t,e)}removeFloor(t){u(this.floors,t)}getWidth(){return this.width}getHeight(){return this.height}getAmountOfFloors(){return this.floors.length}}let y=null;function x(t){y=t,L()}var T;!function(t){t[t.TILES=0]="TILES",t[t.CONNECTIONS=1]="CONNECTIONS",t[t.RESULT=2]="RESULT"}(T||(T={}));const I=Object.keys(T).length/2;let C,S=0,E=T.TILES,O=0;function _(t,e){C&&(E===T.TILES?C.render(!1,{isolate:t,select:e}):E===T.CONNECTIONS?C.render(!0,{debugConnectionsMode:!0,isolate:t,select:e}):E===T.RESULT&&C.render(!0,{isolate:t,select:e}))}function b(t,e){x(new p({width:t,height:e})),L()}function L(){var t,e,n,o;y?(C=null!==(e=y.getFloorByLevel(null!==(t=y.defaultFloor)&&void 0!==t?t:0))&&void 0!==e?e:y.getFloorByIndex(0),S=null!==(o=y.getIndexByLevel(null!==(n=y.defaultFloor)&&void 0!==n?n:0))&&void 0!==o?o:0,_(),rt.bind()):console.warn("Tried to load an area without first initializing it!")}function N(t,e){C&&E===T.TILES&&(C.setTile(t,e,O),rt.setTile(t,e,O))}function R(t,e,n,o){if(C&&E===T.TILES){if(n<t){const e=t;t=n,n=e}if(o<e){const t=e;e=o,o=t}for(let i=e;i<=o;i++)for(let e=t;e<=n;e++)C.setTile(e,i,O);_()}}function A(t,e,n,o){if(C&&E===T.TILES){if(_(),n<t){const e=t;t=n,n=e}if(o<e){const t=e;e=o,o=t}for(let i=e;i<=o;i++)for(let e=t;e<=n;e++)rt.setTile(e,i,O)}}function B(t,e){if(C&&E===T.CONNECTIONS){const n=C.getConnectionByIndex(O);n&&(n.tx=t,n.ty=e,_())}}function k(){if(C&&E===T.CONNECTIONS){const t=C.getConnectionByIndex(O);if(t){const e="VERTICAL"===t.dir;t.dir=e?"HORIZONTAL":"VERTICAL",_()}}}function U(t,e){if(C&&E===T.CONNECTIONS){const n=C.getConnectionByIndex(O);if(n){const o="VERTICAL"===n.dir,i=Math.max(t-n.tx,1),s=Math.max(e-n.ty,1);n.size=o?i:s,console.log(o,i,s),_()}}}function M(t,e){if(C&&E===T.RESULT){const n=O<-1?C.getLandmarkByIndex(~O-1):C.getIconByIndex(O);n&&(n.x=t,n.y=e,_())}}function z(t,e,n){if((!n||E===n)&&C){const n=Math.floor(t/8),o=Math.floor(e/8);E===T.TILES?O=C.getMapIndexByPosition(n,o):E===T.CONNECTIONS?O=C.getConnectionIndexByPosition(n,o):E===T.RESULT&&(O=C.getIconIndexByPosition(t,e))}}function F(){if(C)if(E===T.TILES)_([O],O);else if(E===T.CONNECTIONS){const t=C.getConnectionByIndex(O);t&&_([t.map1+1,t.map2+1],O)}else if(E===T.RESULT){const t=O<-1?C.getLandmarkByIndex(~O-1):C.getIconByIndex(O);t&&_([t.map+1],O)}}function P(t,e){rt.movePosition(t,e)}function $(){rt.resetPosition(),rt.setZoom(1)}function j(t){"number"==typeof t&&t in T?E=t:(E++,E>=I&&(E=0)),O=0,_()}function D(t){rt.changeZoom(t)}function K(t){if(y&&C){const e=S+t;e>=0&&e<y.getAmountOfFloors()&&(C=y.getFloorByIndex(e),S=e,_())}}let Y=!1,J=!1,V=!1,W=0,X=0,Z=0,H=0,G=!1;const q={Minus:()=>D(-1),Equal:()=>D(1),KeyQ:()=>K(-1),KeyE:()=>K(1),ArrowUp:t=>P(0,t?-100:-50),ArrowDown:t=>P(0,t?100:50),ArrowLeft:t=>P(t?-100:-50,0),ArrowRight:t=>P(t?100:50,0),KeyR:()=>$(),Digit1:()=>j(T.TILES),Digit2:()=>j(T.CONNECTIONS),Digit3:()=>j(T.RESULT)};function Q(t){const e=t.offsetX,n=t.offsetY,o=Math.floor(e/8),i=Math.floor(n/8),s=t.shiftKey;0===t.button?(z(e,n,T.CONNECTIONS),z(e,n,T.RESULT),s?(W=o,X=i,Z=o,H=i,A(o,i,o,i)):N(o,i),Y=!0,G=!1):1===t.button?(t.preventDefault(),t.stopImmediatePropagation(),nt.start(e,n),V=!0):2===t.button&&(ot.start(e,n),J=!0)}function tt(t){const e=t.offsetX,n=t.offsetY,o=Math.floor(e/8),i=Math.floor(n/8),s=t.shiftKey;Y&&(o!==Z&&i!==H&&(s?(Z=o,H=i,A(W,X,o,i),U(o,i)):(N(o,i),B(o,i),M(e,n))),G=!0),V&&nt.move(e,n),J&&ot.move(e,n)}function et(t){const e=t.offsetX,n=t.offsetY,o=Math.floor(e/8),i=Math.floor(n/8),s=t.shiftKey;Y&&(s&&R(W,X,o,i),G||k()),V&&nt.stop(e,n),J&&ot.stop(e,n),Y=!1,V=!1,J=!1}const nt={lastX:0,lastY:0,start(t,e){this.lastX=t,this.lastY=e},move(t,e){const n=t-this.lastX,o=e-this.lastY;P(n,o),this.lastX=t-n,this.lastY=e-o},stop(t,e){}},ot={start(t,e){z(t,e),F()},move(t,e){},stop(t,e){_()}},it=new Image;it.src="tiles.png";const st=new Image;st.src="icons.png";var rt=new class{constructor(){this.canvas=document.createElement("canvas"),this.canvas.style.imageRendering="pixelated",this.canvas.style.position="absolute",this.canvas.style.top="50%",this.canvas.style.left="50%",this.context=this.canvas.getContext("2d"),this.offsetX=0,this.offsetY=0,this.factor=1,this.pushTransform(),this.generateTiles(s.from([[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,0,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,1,0,1,0,1,1,1,0,1,1,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,0,1,0,1,0,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,1,1,0,0,1,0,0,0,0,1,1,1,0,1,1,0,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,1,0,1,0,1,0,0,1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,0,0,1,1,1,0,1,1,0,0,1,1,1,0,0,1,0,0,1,1,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1,1,0,0,1,1,1,0,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,1,1,0,0,0,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,1,1,1,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,1,0,0,1,1,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,1,0,1,0,1,1,1,0,0,1,0,0,1,0,1,0,1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0,1,1,0,0,1,1,0,0,1,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,0,1,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,1,0,0,1,1,0,0,1,1,1,0,1,0,1,0,1,0,1,0,1,1,1,0,1,0,1,0,1,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]),[1]),this.resetPosition()}setTile(t,e,n,o=!1){this.context&&!this.isOutOfBounds(t,e)&&(this.context.fillStyle=o?"#"+n.toString(16).padStart(6,"0"):i.getColor(n),this.context.fillRect(8*t,8*e,8,8))}drawTile(t,e,n){if(this.context&&!this.isOutOfBounds(t,e))for(const o of n)this.context.drawImage(it,o[0]||0,o[1]||0,o[2]||8,o[3]||8,8*t+(o[4]||0),8*e+(o[5]||0),o[2]||8,o[3]||8)}drawIcon(t,e,n){var o;if(!(n in at))throw`"${n}" is not a valid icon name!`;if(this.context&&!this.isOutOfBounds(t/8,e/8)){const i=at[n];null===(o=this.context)||void 0===o||o.drawImage(st,i[0]||0,i[1]||0,i[2]||12,i[3]||12,t+(i[4]||-6),e+(i[5]||-6),i[2]||12,i[3]||12)}}isOutOfBounds(t,e){return t<0||t>=this.canvas.width/8||e<0||e>=this.canvas.height/8}setSize(t,e){this.canvas.width=8*t,this.canvas.height=8*e}movePosition(t,e){this.factor>=1&&(this.offsetX+=t,this.offsetY+=e,this.pushTransform())}resetPosition(){this.offsetX=0,this.offsetY=0,this.pushTransform()}setZoom(t){if(t%1!=0)throw`Renderer.setZoom(${t}) was called with a non-integer number!`;this.factor=t,this.pushTransform()}changeZoom(t){if(t%1!=0)throw`Renderer.changeZoom(${t}) was called with a non-integer number!`;this.factor+=t,this.factor<1&&(this.factor=1),this.pushTransform()}pushTransform(){let t=this.factor;t<=0&&(t=Math.abs(1/(t-2))),this.canvas.style.transform=`translate(-50%, -50%) translate(${this.offsetX}px, ${this.offsetY}px) scale(${t})`}generateTiles(t,e){this.setSize(t.getWidth(),t.getHeight()),t.iterate((t,n,o)=>{e?this.setTile(t,n,e.includes(o)?16777215:0,!0):this.setTile(t,n,o)})}generateTilesAdvanced(t,e){const n=t.getWidth(),o=t.getHeight();this.setSize(n,o);for(let i=0;i<o;i++)for(let s=0;s<n;s++){const r=t.get(s,i);if(void 0!==r)if(0===r||e&&!e.includes(r))this.drawTile(s,i,lt.void);else{const e=0!==i&&t.get(s,i-1)===r,l=i!==o-1&&t.get(s,i+1)===r,a=0!==s&&t.get(s-1,i)===r,h=s!==n-1&&t.get(s+1,i)===r,c=0!==i&&0!==s&&t.get(s-1,i-1)!==r,d=0!==i&&s!==n-1&&t.get(s+1,i-1)!==r,u=i!==o-1&&0!==s&&t.get(s-1,i+1)!==r,f=i!==o-1&&s!==n-1&&t.get(s+1,i+1)!==r;this.drawTile(s,i,lt.tiles[+e<<3|+l<<2|+a<<1|+h]),e&&a&&c&&this.drawTile(s,i,lt.vertex.nw),e&&h&&d&&this.drawTile(s,i,lt.vertex.ne),l&&a&&u&&this.drawTile(s,i,lt.vertex.sw),l&&h&&f&&this.drawTile(s,i,lt.vertex.se)}else console.warn(`Point (${s}, ${i}) was outside of the grid!`)}}drawConnection(t,e,n=!1,o=1){const i=n?"vertical":"horizontal";this.drawTile(t,e,lt.connection[i].main);for(let s=1;s<Math.max(1,o);s++){let o=n?s:0,r=n?0:s,l=n?s-1:0,a=n?0:s-1;this.drawTile(t+o,e+r,lt.connection[i].main),this.drawTile(t+l,e+a,lt.connection[i].extend)}}drawDebugConnection(t,e,n=!1,o=1){if(this.setTile(t,e,16711680,!0),n){this.setTile(t,e+1,65280,!0);for(let n=1;n<o;n++)this.setTile(t+n,e,255,!0),this.setTile(t+n,e+1,255,!0)}else{this.setTile(t+1,e,65280,!0);for(let n=1;n<o;n++)this.setTile(t,e+n,255,!0),this.setTile(t+1,e+n,255,!0)}}getIconBounds(t,e,n){if(!(n in at))throw`"${n}" is not a valid icon name!`;const o=at[n],i=t+(o[4]||-6),s=e+(o[5]||-6);return[i,s,i+(o[2]||12),s+(o[3]||12)]}bind(){var t;(t=this.canvas).onmousedown=Q,t.onmousemove=tt,t.onmouseup=et,t.onmouseleave=et,window.onwheel=t=>{const e=t.shiftKey;t.deltaY<0?e?K(1):D(1):t.deltaY>0&&(e?K(-1):D(-1))},t.oncontextmenu=t=>t.preventDefault(),window.onkeydown=t=>{t.code in q&&q[t.code](t.shiftKey)}}attach(){document.body.appendChild(this.canvas)}};const lt={void:[[0,0,8,8]],voidLarge:[[0,0,16,16]],tiles:[[[40,0]],[[16,0,8,4],[16,12,8,4,0,4]],[[24,0,8,4],[24,12,8,4,0,4]],[[20,0,8,4],[20,12,8,4,0,4]],[[16,0,4,8],[28,0,4,8,4,0]],[[16,0]],[[24,0]],[[20,0]],[[16,8,4,8],[28,8,4,8,4,0]],[[16,8]],[[24,8]],[[20,8]],[[16,4,4,8],[28,4,4,8,4,0]],[[16,4]],[[24,4]],[[20,4]]],vertex:{nw:[[32,0,4,4,0,0]],ne:[[36,0,4,4,4,0]],sw:[[32,4,4,4,0,4]],se:[[36,4,4,4,4,4]]},connection:{vertical:{main:[[40,8,8,2,0,6],[40,10,8,3,0,8]],extend:[[17,3,8,2,4,6],[17,3,8,3,4,8]]},horizontal:{main:[[32,8,3,8,5,0],[35,8,2,8,8,0]],extend:[[17,3,3,8,5,4],[17,3,2,8,8,4]]}}},at={arrow_up:[0,0],arrow_down:[12,0],arrow_left:[24,0],arrow_right:[36,0],floor_down:[48,0],weapons:[60,0],quest:[72,0],entrance:[84,0],chest:[96,0],area_up:[0,12],area_down:[12,12],area_left:[24,12],area_right:[36,12],shop:[48,12],trader:[60,12],quest_hub:[72,12],landmark:[84,12,16,16,-7,-8]};let ht="area.json";function ct(t){try{x(new p(JSON.parse(t)))}catch(t){x(new p)}}function dt(t){if(t.preventDefault(),t.dataTransfer)for(const e of t.dataTransfer.items){const t=e.getAsFile();if(t&&t.name.endsWith(".json")){ht=t.name;const e=new FileReader;e.readAsText(t,"UTF-8"),e.onload=()=>{ct(e.result)}}}}function ut(){if(y){const t=document.createElement("a");t.download=ht,t.href=window.URL.createObjectURL(new Blob([JSON.stringify(y)],{type:"text/plain"})),t.click(),t.remove()}}rt.attach(),document.body.ondrop=dt,document.body.ondragover=t=>t.preventDefault(),(new class{constructor(){const t=document.createElement("button");t.onclick=ut,t.innerText="Download",this.element=t}attach(){document.body.appendChild(this.element)}}).attach(),Object.assign(window,{Renderer:rt,Gateway:o})}]);